# **소셜 로그인과 파이어베이스 인증하기 (소셜 로그인, OAuth 2.0, 파이어베이스 인증, 구글 로그인 세팅)**
# **사전 지식**  
# **소셜 로그인과 OAuth 2.0**  
현대 앱 개발에서 소셜 로그인은 더 이상 빼놓을 수 없는 기능 중 하나다. 사용자에게 간단함과 편리함을 주기 떄문이다. 소셜 
로그인의 예로 앱에서 흔히 볼 수 있는 구글 로그인, 애플 로그인 등이 있다.  
  
# **소셜 로그인을 사용하면 얻을 수 있는 이점**  
소셜 로그인을 사용하면 다양한 이점이 있다. 첫 번째는 사용자가 서비스별로 다른 비밀번호를 기억해야 하는 번거로움을 줄일 
수 있고 복잡한 회원가입 절차를 간소화할 수 있다. 두 번째는 다른 서비스와 계정 정보를 연동하므로 악의적인 사용자의 가짜 
계정 생성을 어렵게 할 수 있다. 세 번째로 직접적인 인증을 진행하지 않으며 비밀번호 관리를 서비스 개발자가 직접하지 않으므로 
리소스를 절약할 수 있다. 마지막으로 간소한 사용자 인증 절차 덕분에 앱의 사용자 경험을 증진시킬 수 있다.  
  
소셜 로그인을 진행하려면 소셜 로그인 프로바이더에 앱을 등록해야 한다. 앱을 등록할 때 앱의 정보와 함께 리다리엑트 URL을 
등록한다. 리다이렉트 URL은 소셜 로그인 프로바이더에서 사용자 인증이 끝난 후 인증 코드를 반환할 URL이다. 앱의 경우 앱 스킴을 
사용하여 앱으로 다시 돌아오게 할 수 있다. URL 스킴을 사용하면 앱과 앱 사이의 이동이 쉬워진다. 앱을 등록하면 클라이언트 ID와 
클라이언트 Secret을 배정받는다. 이 값을 이용해서 소셜 로그인 프로바이더에 인증 요청을 할 수 있다.  
  
# **소셜 로그인 진행 방식 알아보기**  
다음 그림에서 소셜 로그인의 진행 방식을 알아본다. 구글 로그인을 진행한다는 가정하에 진행한다. 다른 소셜 로그인 프로바이더를 
사용해도 내부 구성은 OAuth 2.0이므로 로직은 같다.  
  
![img.png](image/img.png)  
  
사용자가 구글로 로그인 버튼을 누르면 소셜 로그인이 시작된다. 구글 로그인 요청이 생기면 앱은 클라이언트 ID와 리다이렉트 URL, 
요청할 스코프를 구글 서버에 전송한다. 그러면 구글 서버는 구글 로그인 창을 실행한다. 만약에 이미 로그인이 되어 있다면 
로그인이 된 계정을 선택할 수 있는 창이 실행된다. 앱이 사용자의 정보에 접근하는 걸 사용자가 허가해주면 리다이렉트 URL 
또는 앱으로 인증 코드가 전송된다. 구글 서버의 토큰 발급 URL로 인증 코드, 클라이언트 ID, 클라이언트 Secret을 보내면 
액세스 토큰을 발급받을 수 있다. 액세스 토큰을 사용하면 구글 서버로부터 허가된 사용자 정보를 받아올 수 있다.  
  
요청할 스코프는 받고 싶은 사용자의 정보와 권한의 레벨을 정의하는 값이다.  
  
# **파이어베이스 인증**  
대표적인 소셜 로그인 프로바이더는 OAuth 2.0 스펙을 사용하므로 인증 로직은 대부분 비슷하다. 하지만 각 소셜 로그인별로 제공하는 
SDK의 사용법과 사용자 정보를 반환하는 값은 서로 다르며 요구하는 스펙 또한 다양하다. 그리고 보통은 최소 3개 이상의 소셜 
로그인 프로바이더로 앱을 개발하는 경우가 많다. 그래서 만약 서비스에서 제공할 모든 소셜 로그인 프로바이더의 연동을 직접 
구현한다면 각각 연동하는 과정은 매우 힘들 수 있다.  
  
![img.png](image/img2.png)  
  
그래서 Firebase, Auth0, Okta, Supabase 등은 소셜 로그인 기능을 자사 서비스 SDK 하나로 묶어 제공하여 소셜 로그인 
연동을 수월하게 해준다. 만약 제작 중인 서비스에 하나의 소셜 로그인 기능만 제공할 계획이라면 직접 소셜 로그인 프로바이더와 
연동해도 괜찮다. 다만 앱의 여러 소셜 로그인 프로바이더를 연동할 계획이라면 앞서 언급한 연동을 쉽게 해주는 서비스를 
사용하는 것도 좋은 방법이다.  
  
Auth0, Okta, Supabase는 이 기능을 유료로 제공하고 파이어베이스 인증은 이 서비스를 무료로 제공한다.  
  
![img.png](image/img3.png)  
  
# **구글 로그인 세팅**  
구글 로그인을 사용하려면 파이어베이스 연동 설정을 해야 한다. 구글 로그인뿐만 아니라 파이어스토어를 사용하기 위해서도 
파이어베이스 연동이 필요하다. 파이어베이스 설정은 20장에서 학습했으므로 22장에서 반복하지 않는다. 이번 프로젝트는 20장 
프로젝트를 기반으로 진행한다. 그러므로 파이어베이스 관련 사전 준비가 따로 필요 없다. 하지만 새로운 프로젝트에 구글 로그인을 
세팅한다면 파이어베이스 연동을 해야 한다.  
  
# **사전 준비**  
# **플러터 템플릿 다운로드**  
1. 깃허브의 ch22 프로젝트를 열고 실행하여 캘린더 프로젝트가 정상적으로 실행되면 프로젝트를 진행할 준비가 완료된 것이다.  
  
파이어베이스 추가 이후 실행했을 때 또는 macOS에서 안드로이드 시뮬레이터로 실행 시 multidex error가 발생하면 flutter run 
--debug를 실행하여 설정을 진행한다.  
  

