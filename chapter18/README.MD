# **데이터베이스 연동하기(SQL, SQLite, Drift, Dismissible)**  
# **프로젝트 구상하기**  
18장에서는 로컬 데이터베이스로 SQLite를 사용한다. SQLite를 잘 사용하려면 SQL 문법을 알아야 한다. 드리프트를 이용해서 
SQLite 테이블 및 모델을 형성하고 데이터를 삽입, 업데이트, 조회하기 때문에 직접 SQL문을 작성할 일은 없지만 기초 SQL은 
알아두는 것이 좋다.  
  
# **사전 지식**  
# **SQL, SQLite**  
SQL은 Standard Query Language의 약자로 데이터베이스 언어이다. SQL은 데이터베이스별로 문법이 약간씩은 다르지만 큰 
틀은 공유한다. 서버에서 사용하는 데이터베이스로는 MySQL, 오라클, 포스트그레SQL, DB2, SQL 서버 등이 있다. 이번에 다룰 
SQLite는 프론트엔드에서 흔히 사용하는 데이터베이스이다. 이름에서도 볼 수 있듯이 SQL을 사용하는 비교적 가벼운 데이터베이스다.  
  
이번 프로젝트는 드리프트(Drift)라는 패키지를 사용한다. 그래서 SQL을 직접적으로 사용하진 않겠지만 SQL을 어느 정도 알고 
있어야 드리프트 패키지를 이해하기 쉽다.  
  
# **드리프트 플러그인**  
드리프트 플러그인을 사용하면 직접 SQL을 작성하지 않고도 SQLite를 사용할 수 있다. SQLite 쿼리를 직접 작성할 수도 있지만 
그럴 경우 모든 쿼리를 String으로 작업해야 해서 유지보수가 힘들다. 그래서 드리프트와 같은 객체-관계 모델을 사용한다. 
테이블을 클래스로 표현하고 쿼리를 다트 언어로 표현하면 드리프가 자동으로 해당되는 테이블과 쿼리를 생성한다.  
  
![img.png](imgae/img.png)  
![img.png](imgae/img2.png)  
![img.png](imgae/img3.png)  
![img.png](imgae/img4.png)  
  
# **Dismissible 위젯**  
Dismissible 위젯은 위젯을 밀어서 삭제하는 기능을 제공한다. 밀어서 삭제하기를 구현하고 싶은 위젯을 Dismissible 위젯으로 
감싸고 onDismissed와 key 매개변수를 입력해주면 된다.  
  
![img.png](imgae/img5.png)  
  
아래 표는 삭제 방향을 표현하는 DismissDirection enum의 값들을 정리한 표다.  
  
![img.png](imgae/img6.png)  
  
# **구현하기**  
드리프트 설정부터 진행한다. SQLite 데이터베이스를 사용하려면 가장 먼저 테이블을 생성해야 한다. 드리프트로 테이블을 
생성하고 테이블에 데이터를 조회, 삽입, 업데이트, 삭제하는 기능을 만든다. 마지막으로 17장에서 구현한 UI와 18장에서 
구현한 기능을 연동해서 로컬데이터베이스를 사용하는 일정 앱을 완성한다.  
  
# **모델 구현하기**  
데이터베이스를 설계할 때 모델을 구현하는 일이 중요하다. 개별 테이블을 잘 만들고 잘 연동되도록 설계해야 손쉽게 SQLite를 
사용할 수 있다. 이 책에서는 직접 SQLite를 사용하지 않고 코드를 이용해 데이터베이스를 사용할 수 있는 드리프트를 사용해 
작업한다.  
  
1. lib/model/schedule.dart 파일을 생성해서 테이블을 생성한다. 드리프트를 사용하면 클래스를 선언해서 테이블을 생성할 
수 있다. 테이블은 드리프트 패키지의 Table 클래스를 상속하면 선언할 수 있다. 그다음 자식 클래스에 열로 정의하고 싶은 
값들을 게터로 선언해주면 된다. 열 선언은 세 가지 요소로 나뉘어진다. 열의 타입, 열의 이름, 열의 속성이다. 열의 타입으로는 
IntColumn, TextColumn, DateTimeColumn 등이 있다. 이름 그대로 어떤 타입의 열인지를 정의할 수 있으며 SQLite에 존재하는 
열 타입들을 모두 사용할 수 있다. 열 이름은 일반적으로 클래스에서 게터를 선언하듯이 작성하면 된다. 열 속성은 무조건 열의 
타입으로부터 시작된다. 그다음 추가하고 싶은 속성이 있다면 함수를 이어서 실행해주면 된다. 다음 코드의 1을 예로 들면 
Integer 타입의 id 열에 AUTOINCREMENT 속성을 추가한다. 모든 속성을 추가했으면 괄호를 여닫으며 함수를 한 번 더 실행해준다. 
그래야 선언한 모든 속성들이 SQL 문법으로 전환된다.  
  
![img.png](imgae/img7.png)  
  
lib -> model -> schedule.dart  
  
